<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Z531JX2XR4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-Z531JX2XR4');
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Space Between Healing</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@300;400;500&display=swap');
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        html, body {
            font-family: 'Noto Serif TC', serif;
            background: #030306;
            color: #e8e4dc;
            overflow: hidden;
            height: 100%;
            height: -webkit-fill-available;
        }
        
        /* ===== ÈÖçÁΩÆÂçÄ ===== */
        :root {
            /* 
             * üîß Âú®ÈÄôË£°Â°´ÂÖ•‰Ω†ÁöÑ n8n Webhook URL
             * ‰æãÂ¶Ç: https://your-n8n.app.n8n.cloud/webhook/healing-chat
             */
            --webhook-url: "YOUR_N8N_WEBHOOK_URL_HERE";
        }
        
        /* ===== ÊòüÁ©∫ËÉåÊôØ ===== */
        #stars-canvas {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 1;
        }
        
        .tunnel-rings {
            position: fixed;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 150vmax; height: 150vmax;
            pointer-events: none;
            z-index: 2;
        }
        
        .tunnel-ring {
            position: absolute;
            top: 50%; left: 50%;
            border: 1px solid rgba(212, 165, 116, 0.08);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            animation: ringPulse 5s ease-in-out infinite;
        }
        
        .tunnel-ring:nth-child(1) { width: 15%; height: 15%; animation-delay: 0s; }
        .tunnel-ring:nth-child(2) { width: 30%; height: 30%; animation-delay: 0.8s; }
        .tunnel-ring:nth-child(3) { width: 45%; height: 45%; animation-delay: 1.6s; }
        .tunnel-ring:nth-child(4) { width: 60%; height: 60%; animation-delay: 2.4s; }
        .tunnel-ring:nth-child(5) { width: 75%; height: 75%; animation-delay: 3.2s; }
        .tunnel-ring:nth-child(6) { width: 90%; height: 90%; animation-delay: 4s; }
        
        @keyframes ringPulse {
            0%, 100% { opacity: 0.3; transform: translate(-50%, -50%) scale(1); }
            50% { opacity: 0.6; transform: translate(-50%, -50%) scale(1.03); }
        }
        
        #warp-overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
        }
        
        #warp-overlay.warping {
            animation: warpFlash 1s ease-in-out;
        }
        
        @keyframes warpFlash {
            0% { opacity: 0; background: radial-gradient(circle, rgba(212,165,116,0) 0%, #030306 100%); }
            40% { opacity: 1; background: radial-gradient(circle, rgba(212,165,116,0.3) 0%, #030306 50%); }
            100% { opacity: 0; background: radial-gradient(circle, rgba(212,165,116,0) 0%, #030306 100%); }
        }
        
        /* ===== Â±§Á¥ö ===== */
        .layer {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10;
            opacity: 0;
            pointer-events: none;
            transform: scale(0.9);
            transition: opacity 0.8s ease, transform 0.8s ease;
            padding: 20px;
        }
        
        .layer.active {
            opacity: 1;
            pointer-events: auto;
            transform: scale(1);
        }
        
        .layer.exiting {
            opacity: 0;
            transform: scale(1.3);
        }
        
        /* ===== ÂÖâÁêÉÁµÑ‰ª∂ ===== */
        .orb-container {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .orb-outer-aura {
            position: absolute;
            width: 180%; height: 180%;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(212, 165, 116, 0.15) 0%, rgba(212, 165, 116, 0.05) 40%, transparent 70%);
            animation: auraBreath 4s ease-in-out infinite;
            pointer-events: none;
        }
        
        @keyframes auraBreath {
            0%, 100% { transform: scale(1); opacity: 0.6; }
            50% { transform: scale(1.15); opacity: 1; }
        }
        
        .orb-ring {
            position: absolute;
            width: 130%; height: 130%;
            border: 1px solid rgba(212, 165, 116, 0.3);
            border-radius: 50%;
            animation: ringRotate 20s linear infinite;
        }
        
        .orb-ring::before {
            content: '';
            position: absolute;
            top: -4px; left: 50%;
            transform: translateX(-50%);
            width: 8px; height: 8px;
            background: #d4a574;
            border-radius: 50%;
            box-shadow: 0 0 15px #d4a574, 0 0 30px #d4a574;
        }
        
        .orb-ring.reverse {
            animation-direction: reverse;
            animation-duration: 25s;
            width: 145%; height: 145%;
            border-color: rgba(125, 184, 168, 0.2);
        }
        
        .orb-ring.reverse::before {
            background: #7db8a8;
            box-shadow: 0 0 15px #7db8a8, 0 0 30px #7db8a8;
        }
        
        @keyframes ringRotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .orb-image {
            width: 100%; height: 100%;
            border-radius: 50%;
            object-fit: cover;
            animation: orbFloat 4s ease-in-out infinite;
            filter: brightness(1.1) contrast(1.05);
        }
        
        @keyframes orbFloat {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-8px) scale(1.02); }
        }
        
        /* ===== ÂÖ•Âè£Â±§ ===== */
        #layer-entrance .orb-container {
            width: 55vmin; height: 55vmin;
            max-width: 300px; max-height: 300px;
            cursor: pointer;
            transition: transform 0.4s ease;
        }
        
        #layer-entrance .orb-container:hover { transform: scale(1.05); }
        
        .entrance-text {
            text-align: center;
            margin-top: 40px;
        }
        
        .entrance-text h1 {
            font-size: clamp(0.85rem, 2.5vw, 1.1rem);
            font-weight: 300;
            letter-spacing: 0.5em;
            color: rgba(232, 228, 220, 0.5);
            margin-bottom: 15px;
            opacity: 0;
            animation: fadeInUp 1s ease 0.3s forwards;
        }
        
        .entrance-text p {
            font-size: clamp(1.1rem, 4vw, 1.4rem);
            font-weight: 300;
            color: rgba(232, 228, 220, 0.85);
            margin-bottom: 35px;
            opacity: 0;
            animation: fadeInUp 1s ease 0.6s forwards;
        }
        
        .enter-btn {
            padding: 14px 55px;
            background: transparent;
            border: 1px solid rgba(212, 165, 116, 0.5);
            color: #d4a574;
            font-family: 'Noto Serif TC', serif;
            font-size: 1rem;
            letter-spacing: 0.3em;
            cursor: pointer;
            transition: all 0.4s ease;
            border-radius: 50px;
            opacity: 0;
            animation: fadeInUp 1s ease 0.9s forwards;
        }
        
        .enter-btn:hover {
            background: rgba(212, 165, 116, 0.12);
            box-shadow: 0 0 40px rgba(212, 165, 116, 0.25);
        }
        
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* ===== ÁêÜÂøµÂ±§ ===== */
        #layer-philosophy {
            text-align: center;
            padding: 30px 25px;
        }
        
        #layer-philosophy .orb-container {
            width: 90px; height: 90px;
            margin-bottom: 40px;
        }
        
        #layer-philosophy .orb-ring { display: none; }
        
        .philosophy-content { max-width: 520px; }
        
        .brand-title {
            font-size: clamp(0.75rem, 2vw, 0.9rem);
            letter-spacing: 0.6em;
            color: rgba(212, 165, 116, 0.6);
            margin-bottom: 50px;
        }
        
        .philosophy-line {
            font-size: clamp(1.05rem, 3.5vw, 1.35rem);
            line-height: 2.4;
            color: rgba(232, 228, 220, 0.85);
            font-weight: 300;
            margin-bottom: 12px;
            opacity: 0;
            transform: translateY(20px);
        }
        
        .philosophy-line span { color: #d4a574; font-weight: 400; }
        
        #layer-philosophy.active .philosophy-line {
            animation: lineReveal 0.8s ease forwards;
        }
        
        #layer-philosophy.active .philosophy-line:nth-child(1) { animation-delay: 0.3s; }
        #layer-philosophy.active .philosophy-line:nth-child(2) { animation-delay: 0.6s; }
        #layer-philosophy.active .philosophy-line:nth-child(3) { animation-delay: 0.9s; }
        #layer-philosophy.active .philosophy-line:nth-child(4) { animation-delay: 1.2s; }
        
        @keyframes lineReveal { to { opacity: 1; transform: translateY(0); } }
        
        .continue-btn {
            margin-top: 55px;
            padding: 14px 45px;
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: rgba(232, 228, 220, 0.6);
            font-family: 'Noto Serif TC', serif;
            font-size: 0.95rem;
            letter-spacing: 0.2em;
            cursor: pointer;
            border-radius: 30px;
            transition: all 0.3s ease;
            opacity: 0;
        }
        
        #layer-philosophy.active .continue-btn {
            animation: fadeInUp 0.8s ease 1.6s forwards;
        }
        
        .continue-btn:hover {
            border-color: rgba(212, 165, 116, 0.5);
            color: #d4a574;
        }
        
        /* ===== ÂºïÂ∞éËÄÖÈÅ∏Êìá ===== */
        #layer-guides { padding: 30px 20px; }
        
        .guides-title {
            text-align: center;
            font-size: clamp(0.9rem, 3vw, 1.1rem);
            font-weight: 300;
            letter-spacing: 0.15em;
            color: rgba(232, 228, 220, 0.6);
            margin-bottom: 35px;
        }
        
        .guides-grid {
            display: flex;
            flex-direction: column;
            gap: 18px;
            width: 100%;
            max-width: 420px;
        }
        
        .guide-card {
            display: flex;
            align-items: center;
            gap: 18px;
            padding: 18px 20px;
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.4s ease;
            opacity: 0;
            transform: translateY(20px);
        }
        
        #layer-guides.active .guide-card { animation: cardReveal 0.6s ease forwards; }
        #layer-guides.active .guide-card:nth-child(1) { animation-delay: 0.2s; }
        #layer-guides.active .guide-card:nth-child(2) { animation-delay: 0.4s; }
        #layer-guides.active .guide-card:nth-child(3) { animation-delay: 0.6s; }
        
        @keyframes cardReveal { to { opacity: 1; transform: translateY(0); } }
        
        .guide-card:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(212, 165, 116, 0.3);
            transform: translateX(5px);
        }
        
        .guide-orb {
            position: relative;
            width: 65px; height: 65px;
            flex-shrink: 0;
        }
        
        .guide-orb img {
            width: 100%; height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }
        
        .guide-card:nth-child(1) .guide-orb img { filter: brightness(1.1) saturate(1.1); }
        .guide-card:nth-child(2) .guide-orb img { filter: brightness(1.05) saturate(0.9) hue-rotate(120deg); }
        .guide-card:nth-child(3) .guide-orb img { filter: brightness(1) saturate(0.7) hue-rotate(180deg); }
        
        .guide-card .guide-orb::after {
            content: '';
            position: absolute;
            inset: -8px;
            border-radius: 50%;
            animation: orbGlow 3s ease-in-out infinite;
        }
        
        .guide-card:nth-child(1) .guide-orb::after { background: radial-gradient(circle, rgba(212, 165, 116, 0.3) 0%, transparent 70%); }
        .guide-card:nth-child(2) .guide-orb::after { background: radial-gradient(circle, rgba(125, 184, 168, 0.3) 0%, transparent 70%); animation-duration: 4s; }
        .guide-card:nth-child(3) .guide-orb::after { background: radial-gradient(circle, rgba(143, 164, 184, 0.3) 0%, transparent 70%); animation-duration: 2.5s; }
        
        @keyframes orbGlow {
            0%, 100% { opacity: 0.6; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.1); }
        }
        
        .guide-info h3 {
            font-size: 1.1rem;
            font-weight: 400;
            color: rgba(232, 228, 220, 0.9);
            margin-bottom: 5px;
        }
        
        .guide-info p {
            font-size: 0.85rem;
            color: rgba(232, 228, 220, 0.5);
            line-height: 1.6;
        }
        
        .guide-arrow {
            margin-left: auto;
            color: rgba(212, 165, 116, 0.3);
            font-size: 1.3rem;
            transition: all 0.3s;
        }
        
        .guide-card:hover .guide-arrow {
            color: rgba(212, 165, 116, 0.8);
            transform: translateX(5px);
        }
        
        /* ===== Â∞çË©±Â±§ ===== */
        #layer-dialogue {
            padding: 20px;
            justify-content: flex-start;
            padding-top: 25px;
        }
        
        .dialogue-scene {
            width: 100%;
            max-width: 520px;
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        
        .ai-presence {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px 0 20px;
        }
        
        .ai-orb-container {
            position: relative;
            width: 100px; height: 100px;
        }
        
        .ai-orb-container .orb-outer-aura {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 160%; height: 160%;
        }
        
        .ai-orb-container img {
            width: 100%; height: 100%;
            border-radius: 50%;
            object-fit: cover;
            transition: all 0.3s ease;
        }
        
        .ai-orb-container.speaking img {
            animation: speakPulse 0.8s ease-in-out infinite;
        }
        
        @keyframes speakPulse {
            0%, 100% { transform: scale(1); filter: brightness(1.1); }
            50% { transform: scale(1.06); filter: brightness(1.25); }
        }
        
        .ai-name {
            margin-top: 12px;
            font-size: 0.95rem;
            color: rgba(232, 228, 220, 0.7);
            letter-spacing: 0.25em;
        }
        
        .dialogue-area {
            flex: 1;
            overflow-y: auto;
            padding: 10px 0;
            -webkit-overflow-scrolling: touch;
        }
        
        .dialogue-messages {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .message {
            max-width: 88%;
            padding: 16px 20px;
            border-radius: 18px;
            font-size: 0.98rem;
            line-height: 1.9;
            opacity: 0;
            transform: translateY(10px);
            animation: messageIn 0.4s ease forwards;
        }
        
        @keyframes messageIn { to { opacity: 1; transform: translateY(0); } }
        
        .message.ai {
            align-self: flex-start;
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: rgba(232, 228, 220, 0.9);
        }
        
        .message.user {
            align-self: flex-end;
            background: rgba(212, 165, 116, 0.12);
            border: 1px solid rgba(212, 165, 116, 0.25);
            color: rgba(232, 228, 220, 0.9);
        }
        
        .typing-indicator {
            display: flex;
            gap: 6px;
            padding: 8px 0;
        }
        
        .typing-dot {
            width: 8px; height: 8px;
            border-radius: 50%;
            background: rgba(212, 165, 116, 0.6);
            animation: bounce 1.4s ease-in-out infinite;
        }
        
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }
        
        @keyframes bounce {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }
        
        /* ===== Ëº∏ÂÖ•ÂçÄ ===== */
        .response-area {
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .free-input-area {
            display: flex;
            gap: 10px;
            align-items: flex-end;
        }
        
        .free-input {
            flex: 1;
            padding: 14px 18px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: 20px;
            color: #e8e4dc;
            font-family: 'Noto Serif TC', serif;
            font-size: 0.95rem;
            resize: none;
            outline: none;
            transition: all 0.3s ease;
            min-height: 50px;
            max-height: 120px;
        }
        
        .free-input::placeholder { color: rgba(232, 228, 220, 0.3); }
        
        .free-input:focus {
            border-color: rgba(212, 165, 116, 0.4);
            background: rgba(255, 255, 255, 0.05);
        }
        
        .send-btn {
            width: 50px; height: 50px;
            border-radius: 50%;
            background: rgba(212, 165, 116, 0.15);
            border: 1px solid rgba(212, 165, 116, 0.4);
            color: #d4a574;
            font-size: 1.3rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .send-btn:hover {
            background: rgba(212, 165, 116, 0.25);
            transform: scale(1.05);
        }
        
        .send-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        
        .input-hint {
            text-align: center;
            font-size: 0.78rem;
            color: rgba(232, 228, 220, 0.3);
            margin-top: 12px;
        }
        
        /* ===== Ê¥ûÂØüÂ±§ ===== */
        #layer-insight {
            text-align: center;
            padding: 30px 25px;
        }
        
        .insight-scene { max-width: 460px; }
        
        #layer-insight .orb-container {
            width: 110px; height: 110px;
            margin: 0 auto 35px;
        }
        
        #layer-insight .orb-outer-aura {
            background: radial-gradient(circle, rgba(212, 165, 116, 0.25) 0%, rgba(212, 165, 116, 0.1) 40%, transparent 70%);
            animation: insightAura 3s ease-in-out infinite;
        }
        
        @keyframes insightAura {
            0%, 100% { transform: scale(1); opacity: 0.7; }
            50% { transform: scale(1.2); opacity: 1; }
        }
        
        .insight-label {
            font-size: 0.8rem;
            letter-spacing: 0.5em;
            color: rgba(212, 165, 116, 0.6);
            margin-bottom: 30px;
        }
        
        .insight-main {
            font-size: clamp(1.05rem, 3.5vw, 1.25rem);
            line-height: 2.3;
            color: rgba(232, 228, 220, 0.9);
            font-weight: 300;
            margin-bottom: 25px;
        }
        
        .insight-hook {
            font-size: 0.95rem;
            color: rgba(232, 228, 220, 0.5);
            font-style: italic;
            padding-top: 25px;
            border-top: 1px solid rgba(255, 255, 255, 0.08);
        }
        
        .cta-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 40px;
        }
        
        .cta-btn {
            padding: 16px 30px;
            border-radius: 30px;
            font-family: 'Noto Serif TC', serif;
            font-size: 0.95rem;
            letter-spacing: 0.15em;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .cta-primary {
            background: rgba(212, 165, 116, 0.18);
            border: 1px solid rgba(212, 165, 116, 0.5);
            color: #d4a574;
        }
        
        .cta-primary:hover {
            background: rgba(212, 165, 116, 0.28);
            box-shadow: 0 0 35px rgba(212, 165, 116, 0.25);
        }
        
        .cta-secondary {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.15);
            color: rgba(232, 228, 220, 0.6);
        }
        
        .cta-secondary:hover {
            border-color: rgba(255, 255, 255, 0.3);
            color: #e8e4dc;
        }
        
        /* ===== Ê°åÈù¢Áâà ===== */
        @media (min-width: 768px) {
            .guides-grid {
                flex-direction: row;
                flex-wrap: wrap;
                justify-content: center;
                max-width: 750px;
                gap: 20px;
            }
            
            .guide-card {
                flex-direction: column;
                text-align: center;
                width: 200px;
                padding: 28px 20px;
            }
            
            .guide-orb { width: 85px; height: 85px; margin-bottom: 5px; }
            .guide-arrow { display: none; }
            .ai-orb-container { width: 120px; height: 120px; }
        }
        
        /* ===== ÈåØË™§ÊèêÁ§∫ ===== */
        .error-toast {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(180, 80, 80, 0.9);
            color: #fff;
            padding: 12px 25px;
            border-radius: 10px;
            font-size: 0.9rem;
            z-index: 2000;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .error-toast.show { opacity: 1; }
    </style>
</head>
<body>
    <canvas id="stars-canvas"></canvas>
    
    <div class="tunnel-rings">
        <div class="tunnel-ring"></div>
        <div class="tunnel-ring"></div>
        <div class="tunnel-ring"></div>
        <div class="tunnel-ring"></div>
        <div class="tunnel-ring"></div>
        <div class="tunnel-ring"></div>
    </div>
    
    <div id="warp-overlay"></div>
    
    <!-- ÈåØË™§ÊèêÁ§∫ -->
    <div class="error-toast" id="error-toast"></div>
    
    <!-- ÂÖ•Âè£ -->
    <div id="layer-entrance" class="layer active">
        <div class="orb-container" onclick="enterPortal()">
            <div class="orb-outer-aura"></div>
            <div class="orb-ring"></div>
            <div class="orb-ring reverse"></div>
            <img src="ai-avatar.png" alt="Portal" class="orb-image">
        </div>
        <div class="entrance-text">
            <h1>SPACE BETWEEN HEALING</h1>
            <p>Ê∫ñÂÇôÂ•ΩÂæÄÂÖßËµ∞‰∫ÜÂóéÔºü</p>
            <button class="enter-btn" onclick="enterPortal()">ÈÄ≤ÂÖ•</button>
        </div>
    </div>
    
    <!-- ÁêÜÂøµ -->
    <div id="layer-philosophy" class="layer">
        <div class="orb-container">
            <div class="orb-outer-aura"></div>
            <img src="ai-avatar.png" alt="" class="orb-image">
        </div>
        <div class="philosophy-content">
            <div class="brand-title">SPACE BETWEEN HEALING</div>
            <p class="philosophy-line">ÊàëÂÄëÁõ∏‰ø°Ôºå<span>Ë£ÇÁóï‰∏çÊòØÁº∫Èô∑</span>„ÄÇ</p>
            <p class="philosophy-line">ÈÇ£ÊòØÂÖâÈÄ≤‰æÜÁöÑÂú∞Êñπ„ÄÇ</p>
            <p class="philosophy-line">ÊØèÂÄãÂìÅÁâåÈÉΩÊúâÂÆÉÁöÑÂÇ∑Âè£ËàáÂõ∞È†ì„ÄÇ</p>
            <p class="philosophy-line">ÊàëÂÄë‰∏ç‰øÆË£úÂÆÉÔºåÊàëÂÄëÁî®<span>Èáë</span>Â°´ÊªøÂÆÉ„ÄÇ</p>
            <button class="continue-btn" onclick="goToGuides()">ÈÅ∏Êìá‰Ω†ÁöÑÂºïÂ∞éËÄÖ</button>
        </div>
    </div>
    
    <!-- ÈÅ∏ÊìáÂºïÂ∞éËÄÖ -->
    <div id="layer-guides" class="layer">
        <div class="guides-title">‰∏â‰ΩçÂºïÂ∞éËÄÖÔºå‰∏âÁ®ÆÁôÇÁôíÁØÄÂ•è</div>
        <div class="guides-grid">
            <div class="guide-card" onclick="selectGuide('guangguang')">
                <div class="guide-orb"><img src="ai-avatar.png" alt="ÂÖâÂÖâ"></div>
                <div class="guide-info">
                    <h3>ÂÖâÂÖâ</h3>
                    <p>ÁÖß‰∫Æ‰ΩÜ‰∏çÂà∫Áúº<br>ËÆì‰Ω†Ëá™Â∑±ÁôºÁèæÁ≠îÊ°à</p>
                </div>
                <div class="guide-arrow">‚Üí</div>
            </div>
            <div class="guide-card" onclick="selectGuide('sumu')">
                <div class="guide-orb"><img src="ai-avatar.png" alt="ËòáÁâß"></div>
                <div class="guide-info">
                    <h3>ËòáÁâß</h3>
                    <p>Èô™‰º¥ËÆì‰Ω†È¨ÜÈñã<br>ÊÖ¢ÊÖ¢‰æÜÔºå‰∏çÁî®ÊÄ•</p>
                </div>
                <div class="guide-arrow">‚Üí</div>
            </div>
            <div class="guide-card" onclick="selectGuide('guyan')">
                <div class="guide-orb"><img src="ai-avatar.png" alt="È°ßË®Ä"></div>
                <div class="guide-info">
                    <h3>È°ßË®Ä</h3>
                    <p>Áõ¥Êé•Ë™™Á†¥ÁúüÁõ∏<br>Êé®‰Ω†‰∏ÄÊää</p>
                </div>
                <div class="guide-arrow">‚Üí</div>
            </div>
        </div>
    </div>
    
    <!-- Â∞çË©± -->
    <div id="layer-dialogue" class="layer">
        <div class="dialogue-scene">
            <div class="ai-presence">
                <div class="ai-orb-container" id="ai-orb-container">
                    <div class="orb-outer-aura" id="ai-aura"></div>
                    <img src="ai-avatar.png" alt="" id="ai-orb-img">
                </div>
                <div class="ai-name" id="ai-name"></div>
            </div>
            
            <div class="dialogue-area">
                <div class="dialogue-messages" id="dialogue-messages"></div>
            </div>
            
            <div class="response-area">
                <div class="free-input-area">
                    <textarea 
                        class="free-input" 
                        id="free-input" 
                        placeholder="Ë™™Ë™™‰Ω†ÁöÑÊÉ≥Ê≥ï‚ãØ‚ãØ"
                        rows="1"
                    ></textarea>
                    <button class="send-btn" id="send-btn" onclick="sendMessage()">‚Üë</button>
                </div>
                <div class="input-hint">Êåâ Enter ÁôºÈÄÅÔºåÊàñÈªûÊìäÁÆ≠È†≠</div>
            </div>
        </div>
    </div>
    
    <!-- Ê¥ûÂØü -->
    <div id="layer-insight" class="layer">
        <div class="insight-scene">
            <div class="orb-container">
                <div class="orb-outer-aura"></div>
                <img src="ai-avatar.png" alt="" class="orb-image">
            </div>
            <div class="insight-label">ÂìÅ Áâå ËÉΩ Èáè Âàù Ë®∫</div>
            <p class="insight-main" id="insight-main"></p>
            <p class="insight-hook">ÈÄôÈÅìË£ÇÁóïËóèËëó‰ªÄÈ∫ºÔºåÈúÄË¶ÅÊõ¥Ê∑±ÁöÑÂ∞çË©±ÊâçËÉΩÁúãË¶ã„ÄÇ</p>
            <div class="cta-buttons">
                <button class="cta-btn cta-primary">È†êÁ¥ÑÊ∑±Â∫¶Ë´ÆË©¢</button>
                <button class="cta-btn cta-secondary">‰∫ÜËß£Ë®ÇÈñ±ÊúçÂãô</button>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // üîß ÈÖçÁΩÆÂçÄ - Âú®ÈÄôË£°Â°´ÂÖ•‰Ω†ÁöÑ n8n Webhook URL
        // ============================================
        const WEBHOOK_URL = 'https://spacebetween.app.n8n.cloud/webhook/brand-healing';
        // ‰æãÂ¶Ç: 'https://your-n8n.app.n8n.cloud/webhook/healing-chat'
        // ============================================
        
        // ÊòüÁ©∫Á≥ªÁµ±
        const canvas = document.getElementById('stars-canvas');
        const ctx = canvas.getContext('2d');
        let stars = [];
        let warpSpeed = 1;
        
        function resize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resize);
        resize();
        
        class Star {
            constructor() { this.reset(); }
            
            reset() {
                const angle = Math.random() * Math.PI * 2;
                const dist = Math.random() * Math.max(canvas.width, canvas.height) * 0.8;
                this.x = canvas.width / 2 + Math.cos(angle) * dist;
                this.y = canvas.height / 2 + Math.sin(angle) * dist;
                this.z = Math.random() * 1500 + 500;
                this.size = Math.random() * 1.5 + 0.5;
                this.color = Math.random() > 0.75 ? '#d4a574' : (Math.random() > 0.5 ? '#7db8a8' : '#ffffff');
            }
            
            update() {
                this.z -= 2 * warpSpeed;
                if (this.z <= 0) { this.reset(); this.z = 1500; }
            }
            
            draw() {
                const scale = 600 / this.z;
                const x = (this.x - canvas.width / 2) * scale + canvas.width / 2;
                const y = (this.y - canvas.height / 2) * scale + canvas.height / 2;
                const size = Math.max(0.5, this.size * scale);
                const opacity = Math.min(1, (1500 - this.z) / 800);
                
                if (x < -50 || x > canvas.width + 50 || y < -50 || y > canvas.height + 50) return;
                
                ctx.beginPath();
                ctx.arc(x, y, size, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.globalAlpha = opacity * 0.8;
                ctx.fill();
                
                if (warpSpeed > 2 && size > 0.8) {
                    const tailLen = warpSpeed * 4;
                    const tx = x + (canvas.width / 2 - x) * 0.015 * tailLen;
                    const ty = y + (canvas.height / 2 - y) * 0.015 * tailLen;
                    ctx.beginPath();
                    ctx.moveTo(x, y);
                    ctx.lineTo(tx, ty);
                    ctx.strokeStyle = this.color;
                    ctx.globalAlpha = opacity * 0.3;
                    ctx.lineWidth = size * 0.6;
                    ctx.stroke();
                }
                ctx.globalAlpha = 1;
            }
        }
        
        const isMobile = window.innerWidth < 768;
        for (let i = 0; i < (isMobile ? 100 : 180); i++) stars.push(new Star());
        
        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            stars.forEach(s => { s.update(); s.draw(); });
            requestAnimationFrame(animate);
        }
        animate();
        
        // Â±§Á¥öÂàáÊèõ
        function warpTo(fromId, toId) {
            const from = document.getElementById(fromId);
            const to = document.getElementById(toId);
            const overlay = document.getElementById('warp-overlay');
            
            warpSpeed = 8;
            overlay.classList.add('warping');
            from.classList.add('exiting');
            
            setTimeout(() => {
                from.classList.remove('active', 'exiting');
                to.classList.add('active');
                warpSpeed = 1;
            }, 500);
            
            setTimeout(() => overlay.classList.remove('warping'), 1000);
        }
        
        function enterPortal() { warpTo('layer-entrance', 'layer-philosophy'); }
        function goToGuides() { warpTo('layer-philosophy', 'layer-guides'); }
        
        // ÂºïÂ∞éËÄÖÈÖçÁΩÆ
        const guideConfig = {
            guangguang: {
                name: 'ÂÖâÂÖâ',
                filter: 'brightness(1.1) saturate(1.1)',
                auraColor: 'rgba(212, 165, 116, 0.25)',
                firstMessage: '‰Ω†‰æÜ‰∫Ü„ÄÇÂú®ÈÄôË£°Ôºå‰∏çÈúÄË¶ÅÂÅáË£ùÊ∏ÖÈÜí„ÄÇÂëäË®¥Êàë‚Äî‚ÄîÊ≠§ÂàªÔºå‰ªÄÈ∫ºËÆì‰Ω†ÊÑüÂà∞Âõ∞‰ΩèÔºü'
            },
            sumu: {
                name: 'ËòáÁâß',
                filter: 'brightness(1.05) saturate(0.9) hue-rotate(120deg)',
                auraColor: 'rgba(125, 184, 168, 0.25)',
                firstMessage: '‰Ω†Â•Ω„ÄÇ‰∏çÁî®ÊÄ•ËëóË™™‰ªÄÈ∫ºÔºåÂÖàÂú®ÈÄôË£°ÂæÖ‰∏ÄÊúÉÂÖí„ÄÇ‰ªäÂ§©ÁöÑ‰Ω†ÔºåÊÑüË¶∫ÊÄéÈ∫ºÊ®£Ôºü'
            },
            guyan: {
                name: 'È°ßË®Ä',
                filter: 'brightness(1) saturate(0.7) hue-rotate(180deg)',
                auraColor: 'rgba(143, 164, 184, 0.25)',
                firstMessage: '‰Ω†‰æÜÊâæÊàëÔºåÈÄöÂ∏∏‰∏çÊòØÂõ†ÁÇ∫Â•ΩÂ•á„ÄÇÊòØÂõ†ÁÇ∫Âç°‰Ωè‰∫Ü„ÄÇË™™Âêß‚Äî‚Äî‰Ω†ÁöÑÂìÅÁâåÔºåÁèæÂú®ÊúÄËÆì‰Ω†‰∏çÂÆâÁöÑÊòØ‰ªÄÈ∫ºÔºü'
            }
        };
        
        let currentGuide = null;
        let conversationHistory = [];
        let messageCount = 0;
        
        // ÈÅ∏ÊìáÂºïÂ∞éËÄÖ
        function selectGuide(key) {
            currentGuide = key;
            conversationHistory = [];
            messageCount = 0;
            
            const config = guideConfig[key];
            const img = document.getElementById('ai-orb-img');
            const aura = document.getElementById('ai-aura');
            const name = document.getElementById('ai-name');
            
            img.style.filter = config.filter;
            aura.style.background = `radial-gradient(circle, ${config.auraColor} 0%, transparent 70%)`;
            name.textContent = config.name;
            
            document.getElementById('dialogue-messages').innerHTML = '';
            
            warpTo('layer-guides', 'layer-dialogue');
            
            setTimeout(() => {
                showAIMessage(config.firstMessage);
                conversationHistory.push({ role: 'assistant', content: config.firstMessage });
            }, 700);
        }
        
        // È°ØÁ§∫ AI Ë®äÊÅØ
        function showAIMessage(text) {
            const container = document.getElementById('dialogue-messages');
            const orbContainer = document.getElementById('ai-orb-container');
            
            orbContainer.classList.add('speaking');
            
            const typing = document.createElement('div');
            typing.className = 'message ai';
            typing.innerHTML = '<div class="typing-indicator"><div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div></div>';
            container.appendChild(typing);
            container.scrollTop = container.scrollHeight;
            
            setTimeout(() => {
                typing.remove();
                orbContainer.classList.remove('speaking');
                
                const msg = document.createElement('div');
                msg.className = 'message ai';
                msg.textContent = text;
                container.appendChild(msg);
                container.scrollTop = container.scrollHeight;
                
                document.getElementById('free-input').disabled = false;
                document.getElementById('send-btn').disabled = false;
                document.getElementById('free-input').focus();
            }, 1000);
        }
        
        // È°ØÁ§∫Áî®Êà∂Ë®äÊÅØ
        function showUserMessage(text) {
            const container = document.getElementById('dialogue-messages');
            const msg = document.createElement('div');
            msg.className = 'message user';
            msg.textContent = text;
            container.appendChild(msg);
            container.scrollTop = container.scrollHeight;
        }
        
        // ÁôºÈÄÅË®äÊÅØÂà∞ n8n
        async function sendMessage() {
            const input = document.getElementById('free-input');
            const text = input.value.trim();
            
            if (!text) return;
            
            // Á¶ÅÁî®Ëº∏ÂÖ•
            input.disabled = true;
            document.getElementById('send-btn').disabled = true;
            input.value = '';
            input.style.height = 'auto';
            
            // È°ØÁ§∫Áî®Êà∂Ë®äÊÅØ
            showUserMessage(text);
            conversationHistory.push({ role: 'user', content: text });
            messageCount++;
            
            // Ê™¢Êü•ÊòØÂê¶Âà∞ÈÅîÂ∞çË©±ÁµÇÈªûÔºà‰æãÂ¶Ç 5 Ëº™ÂæåÔºâ
            if (messageCount >= 5) {
                setTimeout(() => {
                    generateInsight();
                }, 500);
                return;
            }
            
            // È°ØÁ§∫ AI Ê≠£Âú®Ëº∏ÂÖ•
            const container = document.getElementById('dialogue-messages');
            const orbContainer = document.getElementById('ai-orb-container');
            orbContainer.classList.add('speaking');
            
            const typing = document.createElement('div');
            typing.className = 'message ai';
            typing.id = 'typing-msg';
            typing.innerHTML = '<div class="typing-indicator"><div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div></div>';
            container.appendChild(typing);
            container.scrollTop = container.scrollHeight;
            
            try {
                // ÂëºÂè´ n8n Webhook
                const response = await fetch(WEBHOOK_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        guide: currentGuide,
                        message: text,
                        history: conversationHistory.slice(0, -1) // ‰∏çÂåÖÂê´ÂâõÁôºÁöÑÈÄôÊ¢ù
                    })
                });
                
                const data = await response.json();
                
                // ÁßªÈô§ÊâìÂ≠óÊåáÁ§∫
                document.getElementById('typing-msg')?.remove();
                orbContainer.classList.remove('speaking');
                
                if (data.success && data.message) {
                    showAIMessage(data.message);
                    conversationHistory.push({ role: 'assistant', content: data.message });
                } else {
                    throw new Error(data.error || 'Unknown error');
                }
                
            } catch (error) {
                console.error('API Error:', error);
                document.getElementById('typing-msg')?.remove();
                orbContainer.classList.remove('speaking');
                
                // È°ØÁ§∫ÈåØË™§
                showError('ÈÄ£Êé•‰∏≠Êñ∑ÔºåË´ãÁ®çÂæåÂÜçË©¶');
                
                // ‰ΩøÁî®ÂÇôÁî®ÂõûÊáâ
                const fallbackResponses = {
                    guangguang: 'ÊàëËÅΩÂà∞‰∫Ü„ÄÇËÆìÊàëÂÄëÊÖ¢ÊÖ¢‰æÜ‚ãØ‚ãØ‰Ω†Ë™™ÁöÑÈÄô‰∫õÔºåËÉåÂæåËóèËëó‰ªÄÈ∫ºÔºü',
                    sumu: 'Ë¨ùË¨ù‰Ω†ÂëäË®¥Êàë„ÄÇ‰∏çÁî®ÊÄ•ÔºåÊàëÂÄëÂèØ‰ª•ÊÖ¢ÊÖ¢ËÅä‚ãØ‚ãØ',
                    guyan: 'ÁπºÁ∫åË™™„ÄÇ‰Ω†ÈÇÑÊ≤íË™™Âà∞ÈáçÈªû„ÄÇ'
                };
                
                setTimeout(() => {
                    showAIMessage(fallbackResponses[currentGuide]);
                }, 1500);
            }
        }
        
        // ÁîüÊàêÊ¥ûÂØü
        function generateInsight() {
            const insights = {
                guangguang: '‰Ω†ÁöÑÂìÅÁâåÊ≠£Âú®‰øùË≠∑‰∏ÄÂÄãÂÆÉ‰ª•ÁÇ∫ÂæàËÑÜÂº±ÁöÑÊ†∏ÂøÉ„ÄÇ‰ΩÜÈÇ£ÂÄãÊ†∏ÂøÉÔºåÂÖ∂ÂØ¶ÊòØ‰Ω†ÊúÄÁèçË≤¥ÁöÑÊù±Ë•ø‚Äî‚ÄîÂÆÉÂè™ÊòØÈÇÑÊ≤íË¢´ÂÖÅË®±ÁôºÂÖâ„ÄÇ',
                sumu: '‰Ω†ÁöÑÂìÅÁâåÈúÄË¶ÅÁöÑ‰∏çÊòØÊõ¥Â§öÁ≠ñÁï•ÔºåËÄåÊòØ‰∏ÄÂÄã„ÄåÂÖÅË®±„Äç‚Äî‚ÄîÂÖÅË®±ÂÆÉ‰∏çÂøÖÂÆåÁæéÔºåÂÖÅË®±ÂÆÉÊúâËá™Â∑±ÁöÑÁØÄÂ•èÔºåÂÖÅË®±ÂÆÉÂú®Ê∑∑‰∫Ç‰∏≠ÊÖ¢ÊÖ¢ÊâæÂà∞Ëá™Â∑±ÁöÑÂΩ¢ÁãÄ„ÄÇ',
                guyan: '‰Ω†ÁöÑÂìÅÁâåÂú®ÊííÁöÑË¨äÔºåÂÖ∂ÂØ¶ÊòØ‰Ω†Â∞çËá™Â∑±ÊííÁöÑË¨ä„ÄÇÂ•ΩÊ∂àÊÅØÊòØÔºöÁï∂‰Ω†Êï¢Ë™™Âá∫‰æÜÁöÑÈÇ£‰∏ÄÂàªÔºåË¨äË®ÄÂ∞±ÈñãÂßãÂ§±ÂéªÂäõÈáè‰∫Ü„ÄÇ'
            };
            
            document.getElementById('insight-main').textContent = insights[currentGuide];
            warpTo('layer-dialogue', 'layer-insight');
        }
        
        // È°ØÁ§∫ÈåØË™§
        function showError(msg) {
            const toast = document.getElementById('error-toast');
            toast.textContent = msg;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }
        
        // Enter ÁôºÈÄÅ
        document.getElementById('free-input').addEventListener('keypress', e => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });
        
        // Ëá™ÂãïË™øÊï¥Ëº∏ÂÖ•Ê°ÜÈ´òÂ∫¶
        document.getElementById('free-input').addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = Math.min(this.scrollHeight, 120) + 'px';
        });
    </script>
</body>
</html>
